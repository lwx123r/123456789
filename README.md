# 123456789
# 葡萄酒分类数据分析项目

## 项目概述

本项目旨在通过数据分析和机器学习方法对葡萄酒进行分类。我们使用公开的葡萄酒数据集，通过探索性数据分析、特征工程和多种分类算法，建立能够准确区分不同种类葡萄酒的模型。

## 数据集说明

本项目使用的数据集包含178个样本，每个样本有13个特征和1个类别标签。数据集的主要特征包括：

- Alcohol：酒精含量
- Malic acid：苹果酸含量
- Ash：灰分
- Alcalinity of ash：灰分的碱度
- Magnesium：镁含量
- Total phenols：总酚
- Flavanoids：类黄酮
- Nonflavanoid phenols：非类黄酮酚
- Proanthocyanins：原花青素
- Color intensity：颜色强度
- Hue：色调
- OD280/OD315 of diluted wines：稀释葡萄酒的OD280/OD315
- Proline：脯氨酸

类别标签表示葡萄酒的种类，共有3个类别。

## 项目结构

```
.
├── data.csv              # 葡萄酒数据集
├── wine_classification.py # 数据分析和建模代码
└── README.md             # 项目说明文档
```

## 技术栈

- Python 3.8+
- pandas：数据处理
- matplotlib：数据可视化
- seaborn：高级数据可视化
- scikit-learn：机器学习
- numpy：科学计算

## 数据分析与建模流程

### 1. 数据探索与预处理

首先加载数据并进行初步探索，包括查看数据基本信息、前几行数据和统计描述。然后删除无关的id列，并分析类别分布。

### 2. 特征分析

通过计算特征与类别的相关系数，找出对分类最有影响的特征。使用热图展示所有特征之间的相关性，并通过箱线图直观展示各特征在不同类别中的分布情况。

### 3. 分类模型建立与评估

使用两种分类算法：支持向量机(SVM)和逻辑回归(Logistic Regression)，分别在原始特征和PCA降维后的特征上进行训练和评估。主要步骤包括：

- 数据划分：将数据集划分为训练集和测试集
- 特征标准化：使用StandardScaler对特征进行标准化
- PCA降维：尝试不同数量的主成分
- 模型训练与预测：使用训练集训练模型，在测试集上进行预测
- 模型评估：计算准确率、绘制混淆矩阵
- 时间性能分析：比较不同模型的训练和预测时间

## 主要结果

### 1. 特征相关性分析

通过计算特征与类别的相关系数，发现以下特征与类别相关性较高：

- Alcalinity_of_ash（灰分的碱度）
- Nonflavanoid phenols（非类黄酮酚）
- Malic acid（苹果酸）
- Color intensity（颜色强度）

### 2. 分类模型性能

#### SVM模型

- **原始特征**：测试集准确率约为94.44%
- **PCA降维后（6个主成分）**：测试集准确率约为95.83%
- **不同PCA组件数量的影响**：当主成分数量为6时，准确率达到最高

#### 逻辑回归模型

- **原始特征**：测试集准确率约为91.67%
- **PCA降维后（6个主成分）**：测试集准确率约为93.06%
- **不同PCA组件数量的影响**：当主成分数量为7时，准确率达到最高

### 3. 时间性能比较

- **SVM**：训练时间约为0.001秒，预测时间约为0.0001秒
- **逻辑回归**：训练时间约为0.0005秒，预测时间约为0.0001秒

## 运行方法

1. 确保已安装所需的Python库：
   ```
   pip install pandas matplotlib seaborn scikit-learn numpy
   ```

2. 将数据集`data.csv`放在与代码文件相同的目录下

3. 运行数据分析和建模代码：
   ```
   python wine_classification.py
   ```

4. 程序将输出各模型的准确率、混淆矩阵，并生成多个可视化图表

## 可视化结果

运行代码后，将生成以下可视化图表：

1. 类别分布柱状图
2. 特征与类别相关性条形图
3. 特征相关性热图
4. 各特征在不同类别中的箱线图
5. SVM和逻辑回归模型在不同PCA组件数量下的准确率变化曲线
6. 各模型的混淆矩阵

## 结论

1. 葡萄酒的多个化学成分与类别有较强的相关性，可用于分类
2. PCA降维在保持较高准确率的同时，减少了特征数量
3. SVM模型在该数据集上的表现略优于逻辑回归模型
4. 对于该数据集，使用6-7个主成分即可获得较好的分类效果

本项目展示了从数据探索到模型建立的完整流程，为葡萄酒分类提供了有效的解决方案。未来可以尝试更多的特征工程方法和其他分类算法，进一步提高模型性能。
